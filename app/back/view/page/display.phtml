                        <h1>Gestion des pages</h1>

<?php
    $this->add('breadcrumbs.phtml');
?>

                        <h2><?php echo ($this->pages[BACK_ID_VERSION]->getMeta() ? 'Modification de ' : 'Création de ') . strtolower($this->pages[BACK_ID_VERSION]->getGabarit()->getLabel()); ?></h2>

<?php
    if (count($this->versions) > 0) {
?>
                        <div>
<?php
        foreach ($this->versions as $id_version => $version) {
            $page = $this->pages[$id_version];
?>
                            <div style="height: 54px;float: left;">
                                <div class="btn-a gradient-blue" style="margin-bottom: 5px;display:block;">
                                    <a title="<?php echo $version['nom']; ?>" class="openlang <?php echo $id_version == BACK_ID_VERSION ? 'active' : 'translucide'; ?>">
                                        Langue : <img src="img/flags/png/<?php echo strtolower($version['suf']); ?>.png" alt="<?php echo $version['nom']; ?>" />
                                    </a>
                                </div>

<?php
            if ($page->getMeta("rewriting") != "") {
                if ($page->getGabarit()->getMake_hidden()
                    || $this->utilisateur->get("niveau") == "solire"
                    || !$page->getMeta("visible")
                ) {
?>
                                <div style="margin-left: 6px;margin-top: -7px;">
                                    <label style="color:#A1A1A1;display:inline;text-shadow:none;margin-left:10px;" for="visible-<?php echo $id_version; ?>">Visible : </label>
                                    <input class="visible-lang visible-lang-<?php echo $page->getMeta("id") . '-' . $id_version; ?>" style="margin:0;" value="<?php echo $page->getMeta("id") . '|' . $id_version; ?>" id="visible-<?php echo $id_version; ?>" type="checkbox"<?php if ($page->getMeta("visible")) { echo ' checked="checked"'; }?> />
                                </div>
<?php
                }
            }else {
?>
                                <span class="notification gradient-red" style="margin-left: 6px;">Non traduit</span>
<?php
            }
?>
                            </div>
<?php
        }
?>
                        </div>

<?php
    }

    foreach ($this->pages as $page) {
?>
                        <div class="langue" id="langue_<?php echo $page->getMeta('id_version'); ?>" style="clear:both;<?php if ($page->getMeta('id_version') != BACK_ID_VERSION && count($this->pages) > 1) { echo ' display:none;'; } ?>">
<?php
        if (count($this->versions) > 1) {
?>
                        <div style="margin-top:0" class="clearin"></div>

                        <div>
                            <select class="compareversion-other fl" style="display:block;">
<?php
            foreach ($this->versions as $id_version => $version) {
                if ($id_version != $page->getMeta('id_version')) {
?>
                                <option value="<?php echo $id_version . '|' . strtolower($version['suf']); ?>"><?php echo $version['nom']; ?></option>
<?php
                }
            }
?>
                            </select>

                            <button class="btn-a gradient-green fl compareversion-submit" style="padding: 9px 18px; font-size: 12px; display: block; font-family: Arial; line-height: 12px;">Comparer</button>
                            <button class="btn-a gradient-green fl compareversion-hide" style="padding: 9px 18px; font-size: 12px; display: block; font-family: Arial; line-height: 12px;">Cacher</button>
                        </div>
<?php
        }
?>

                        <div style="margin-top:0" class="clearin"></div>
<?php
        echo $page->getForm('page/save.html', 'page/liste.html', $this->upload_path, $this->redirections[$id_version]);
?>
                        </div>

<?php
    }
?>

<?php
    if (isset($_GET['popup']) && $_GET['popup'] == 'more') {
?>

                        <div class="modal  hide fade" id="modalMore" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                <h3 id="myModalLabel">Que voulez-vous faire ?</h3>
                            </div>

                            <div class="modal-body">
                                <dl class="">

<?php
        $page = $this->pages[BACK_ID_VERSION];

        if ($page->getMeta("rewriting") != '') {
            if ($page->getGabarit()->getMake_hidden()
                || $this->utilisateur->get('niveau') == 'solire'
                || !$page->getMeta('visible')
            ) {
?>
                                    <dt>Gérer la visibité :</dt><br /><dd><img src="img/flags/png/<?php echo strtolower($this->versions[BACK_ID_VERSION]['suf']); ?>.png" alt="" />
                                    <input class="visible-lang visible-lang-<?php echo $page->getMeta("id") . '-' . BACK_ID_VERSION; ?>" style="margin:0;" value="<?php echo $page->getMeta('id') . '|' . BACK_ID_VERSION; ?>" id="visible-<?php echo BACK_ID_VERSION; ?>" style="margin:0;" <?php echo ($page->getMeta('visible') ? 'checked="checked"' : ''); ?> type="checkbox" /><dd>
<?php
            }
        }
?>
                                    <br />
                                    <br />
                                    <dt>Editer une autre page :</dt>
                                    <br />
                                    <dd>
                                        <div>
                                            <input type="text" placeholder="Recherche" class="search live-search ui-autocomplete-input" autocomplete="off" role="textbox" aria-autocomplete="list" aria-haspopup="true">
                                        </div>
                                    </dd>
                                    <br />

                                    <dt>Créer un nouveau contenu :</dt>
                                    <br />
                                    <dd>
                                        <div style="min-height: 50px;">
                                            <?php $this->add("template/button.phtml"); ?>
                                        </div>
                                    </dd>
                                </dl>
                            </div>

                            <div class="modal-footer">
                                <button class="btn-a gradient-grey btn-large" onclick="var link = $('.back-to-list a').attr('href');window.location = link;">Quitter</button>
                                <button class="btn-a gradient-grey btn-large" data-dismiss="modal" onclick="$('.formprev').click()" aria-hidden="true"><b>Prévisualiser</b></button>
                                <button class="btn-a gradient-blue btn-large" data-dismiss="modal" aria-hidden="true">Continuer l'édition de cette page</button>
                            </div>
                        </div>
<?php
    }
?>
                        <div class="modal hide fade" id="modalCrop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                <h3 id="myModalLabel">Recadrer</h3>
                            </div>

                            <div class="modal-body">
                                <table style="width:100%" class="border-none" border="0">
                                    <tr>
                                        <td style="border:1px solid #CFCFCF;background: black"></td>

                                        <td style="vertical-align:top;">

                                            <form class="form-crop form-horizontal" action="media/crop.html" method="post" style="width: 325px;">
                                                <fieldset class="img-info">
                                                    <legend>Information</legend>
                                                    <div>
                                                        <dl style="display: none" class="dl-horizontal expected-width">
                                                            <dt style="width: 180px;">Largeur minimale attendue</dt>
                                                            <dd style="margin-left: 190px;"><span id="minwidthShow"></span>px</dd>
                                                        </dl>
                                                        <dl style="display: none" class="dl-horizontal expected-height">
                                                            <dt style="width: 180px;">Hauteur minimale attendue</dt>
                                                            <dd style="margin-left: 190px;"><span id="minheightShow"></span>px</dd>
                                                        </dl>
                                                    </div>
                                                </fieldset>

                                                <fieldset>
                                                    <legend>Sélection</legend>
                                                    <div>
                                                        <div class="control-group">
                                                            <label class="control-label" for="wShow">Largeur</label>
                                                            <div class="controls">
                                                                <input type="text" style="width: 60px" class="wShow spinner" id="wShow" placeholder="Largeur" value="" />
                                                            </div>
                                                        </div>
                                                        <div class="control-group">
                                                            <label class="control-label" for="hShow">Hauteur</label>
                                                            <div class="controls">
                                                                <input type="text" style="width: 60px" class="hShow spinner" id="hShow" placeholder="Hauteur" value="" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </fieldset>

                                                <fieldset>
                                                    <legend>Enregistrement</legend>
                                                    <div>
                                                        <div class="control-group">
                                                            <label class="radio expected-height">
                                                                <input type="radio" value="height" class="" name="force-width">Respecter la hauteur minimum
                                                            </label>
                                                            <label class="radio expected-width">
                                                                <input type="radio" value="width" class="" name="force-width">Respecter la largeur minimum
                                                            </label>
                                                            <label class="radio expected-width-height">
                                                                <input type="radio" value="width-height" class="" name="force-width">Respecter la hauteur et la largeur minimum
                                                            </label>

                                                            <label class="radio force-selection">
                                                                <input type="radio"  value="1" name="force-width">Forcer la taille en fonction de la sélection
                                                            </label>
                                                        </div>

                                                        <div class="control-group radio">
                                                            <label class="">Nom de l'image</label>
                                                            <input type="text" id="image-name" name="image-name" class="input-xlarge" placeholder="Nom de l'image" value="" />
                                                            <input type="hidden" id="image-extension" name="image-extension"  />
                                                        </div>
                                                    </div>

                                                    <input type="hidden" id="filepath" name="filepath" />
                                                    <input type="hidden" id="x" name="x" />
                                                    <input type="hidden" id="y" name="y" />
                                                    <input type="hidden" id="w" name="w" />
                                                    <input type="hidden" id="h" name="h" />
                                                    <input type="hidden" id="minwidth" name="minwidth" />
                                                    <input type="hidden" id="minheight" name="minheight" />
                                                </fieldset>
                                            </form>
                                        </td>
                                    </tr>
                                </table>
                            </div>

                            <div class="modal-footer">
                                <button class="btn" data-dismiss="modal" aria-hidden="true">Annuler</button>
                                <button class="btn btn-primary form-crop-submit">Recadrer</button>
                            </div>

                        </div>
